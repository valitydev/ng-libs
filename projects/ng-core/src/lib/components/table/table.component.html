<div class="table">
    <v-actions *ngIf="hasToolbar">
        <v-actions *ngIf="hasUpdate">
            <button
                [disabled]="inProgress"
                mat-stroked-button
                (click)="update.emit(this.size$.value ? { size: this.size$.value } : {})"
            >
                Update
            </button>
            <ng-container *ngIf="hasSizes">
                <button [disabled]="inProgress" [matMenuTriggerFor]="menu" mat-button>
                    {{ size$ | async }} <mat-icon>table_rows_narrow</mat-icon>
                </button>
                <mat-menu #menu="matMenu">
                    <button
                        *ngFor="let size of renderedSizes"
                        mat-menu-item
                        (click)="size$.next(size)"
                    >
                        {{ size }}
                    </button>
                </mat-menu>
            </ng-container>
        </v-actions>
        <ng-content select="v-table-actions"></ng-content>
    </v-actions>

    <mat-card class="table-card">
        <mtx-grid
            [cellSelectable]="false"
            [cellTemplate]="cellTemplate"
            [columns]="renderedColumns"
            [data]="data"
            [loading]="inProgress || !columns"
            [paginationTemplate]="footerTpl"
            [rowSelectable]="rowSelectable"
            [trackBy]="trackBy"
            (rowSelectionChange)="rowSelectionChange.emit($event)"
        ></mtx-grid>
        <ng-template #footerTpl>
            <button
                *ngIf="hasMore"
                [disabled]="inProgress"
                mat-button
                style="width: 100%"
                (click)="more.emit(this.size$.value ? { size: this.size$.value } : {})"
            >
                {{ inProgress ? 'Loading...' : 'Show more' }}
            </button>
        </ng-template>
    </mat-card>
</div>
