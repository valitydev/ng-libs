<mat-card class="table-card">
    <v-progress-bar [progress]="progress()"></v-progress-bar>
    <table #table [dataSource]="dataSource" mat-table>
        @for (col of normalizedColumns(); track col; let colIndex = $index) {
            <ng-container [matColumnDef]="col.field">
                <th *matHeaderCellDef mat-header-cell>
                    <v-value [value]="(col.header | async) ?? undefined"></v-value>
                </th>
                <td *matCellDef="let row; let rowIndex = index" mat-cell>
                    <v-value [value]="(columnsData$ | async)?.[colIndex]?.[rowIndex]"></v-value>
                </td>
            </ng-container>
        }
        <v-no-records-column
            [name]="columnDefs.noRecords"
            [progress]="progress()"
        ></v-no-records-column>

        <tr *matHeaderRowDef="rowDefs()" mat-header-row></tr>
        <tr *matRowDef="let row; columns: rowDefs()" mat-row></tr>
        <tr
            *matFooterRowDef="footerRowDefs()"
            [style.display]="footerRowDefs().length ? '' : 'none'"
            mat-footer-row
        ></tr>
    </table>
</mat-card>
